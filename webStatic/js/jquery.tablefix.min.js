(function(t){t.fn.tablefix=function(i){return this.each(function(e){var o=t.extend({},i),h=t(this),n=o.width>0,s=o.height>0;if(n?n=o.width<h.width():o.width=h.width(),s?s=o.height<h.height():o.height=h.height(),n||s){n&&s?(o.width-=40,o.height-=40):n?o.width-=20:o.height-=20,h.wrap("<div></div>");var d=h.parent();d.css({position:"relative"});var r=o.fixRows>0?o.fixRows:0,l=o.fixCols>0?o.fixCols:0,c=0,a=0;h.find("tr").each(function(i){if(t(this).find("td,th").each(function(e){if(i==r&&e==l){var o=t(this);return c=o.position().left,a=o.parent("tr").position().top,!1}}),i==r)return!1});var f=h.wrap("<div></div>"),p=h.clone().wrap("<div></div>"),v=h.clone().wrap("<div></div>"),u=h.clone().wrap("<div></div>"),w=u.parent().css({position:"absolute",overflow:"hidden"}),m=p.parent().css({position:"absolute",overflowX:"auto",overflowY:"hidden"}),g=v.parent().css({position:"absolute",overflow:"hidden"}),x=f.parent().css({position:"absolute",overflow:"auto"});w.find("tr").each(function(i){r<=i&&t(this).remove(),t(this).find("th,td").each(function(i){l<=i&&t(this).remove()})}),m.find("tr").each(function(i){r<=i&&t(this).remove(),t(this).find("th,td").each(function(i){i<l&&t(this).remove()})}),g.find("tr").each(function(i){i<r&&t(this).remove(),t(this).find("th,td").each(function(i){l<=i&&t(this).remove()})}),x.find("tr").each(function(i){i<r&&t(this).remove(),t(this).find("th,td").each(function(i){i<l&&t(this).remove()})}),d.append(m).append(g).append(w);var y=o.width-c,b=o.height-a,C=document.createElement("p");C.style.width="100%",C.style.height="200px";var L=document.createElement("div");L.style.position="absolute",L.style.top="0px",L.style.left="0px",L.style.visibility="hidden",L.style.width="200px",L.style.height="150px",L.style.overflow="hidden",L.appendChild(C);var R=null==document.body?document.documentElement:document.body;R.appendChild(L);var T=C.offsetWidth;L.style.overflow="scroll";var E=C.offsetWidth;T==E&&(E=L.clientWidth),R.removeChild(L);var W=T-E;w.width(c).height(a),m.width(y+(n?20:0)+(s?20:0)).height(a+(s?20:0)-3).css({left:c+"px"}),p.css({marginRight:(n?20:0)+(s?20:0)+"px"}),g.width(c).height(b+(n?20:0)+(s?20:0)).css({top:a+"px"}),v.css({marginBottom:(n?20:0)+(s?20:0)+"px",marginTop:(s?20:0)+"px"}),x.width(y+(n?20:0)+(s?20:0)+W).height(b+(n?20:0)+(s?20:0)).css({left:c+"px",top:a+"px"}),f.css({marginRight:(n?20:0)+"px",marginBottom:(s?20:0)+"px",marginTop:(s?20:0)+"px"}),s&&p.width(f.width()),x.scroll(function(){m.scrollLeft(x.scrollLeft()),g.scrollTop(x.scrollTop())}),m.scroll(function(){x.scrollLeft(m.scrollLeft())}),d.width(o.width+(n?20:0)+(s?20:0)).height(o.height+(n?20:0)+(s?20:0))}})}})(jQuery);